2025-06-10 17:46:19,625 - distributed.worker - ERROR - Compute Failed
Key:       ('lambda-d53f8c6ef66ff9a0c855f249bb1d73c3', 99)
State:     executing
Function:  execute_task
args:      ((<function reify at 0x7f0e7462aa60>, (<function map_chunk at 0x7f0e7462ae50>, <function Context.parallel_run.<locals>.<lambda> at 0x7f0e7467d160>, [[{'task': Task(proc=<function run at 0x7f0e74727550>, args=Namespace(input_segmentation_parameters='p30-E165_R1_default_1_ZLevel_cpsam/segmentation_specification.json', tile_index=198, overwrite=True)), 'cnt_args': {'name': './task-198', 'dask_args': {'workers': 3}, 'fs_args': {'aws_profile_name': None, 'aws_access_key': None, 'aws_secret_key': None, 'gcs_service_account_key': None}, 'log_args': {'fname': None, 'lvl': 2, 'verbose': True}, 'prof_args': {'profile_file': None}}}, {'task': Task(proc=<function run at 0x7f0e74727550>, args=Namespace(input_segmentation_parameters='p30-E165_R1_default_1_ZLevel_cpsam/segmentation_specification.json', tile_index=199, overwrite=True)), 'cnt_args': {'name': './task-199', 'dask_args': {'workers': 3}, 'fs_args': {'aws_profile_name': None, 'aws_access_key': None, 'aws_secret_key': None, 'gcs_service_acco
kwargs:    {}
Exception: 'RuntimeError(\'Long error message\', \'Error(s) in loading state_dict for CPnet:\\n\\tMissing key(s) in state_dict: "downsample.down.res_down_0.conv.conv_0.0.weight", "downsample.down.res_down_0.conv.conv_0.0.bias", "downsample.down.res_down_0.conv.conv_0.0.running_mean", "downsample.down.res_down_0.conv.conv_0.0.running_var", "downsample.down.res_down_0.conv.conv_0.2.weight", "downsample.down.res_down_0.conv.conv_0.2.bias", "downsample.down.res_down_0.conv.conv_1.0.weight", "downsample.down.res_down_0.conv.conv_1.0.bias", "downsample.down.res_down_0.conv.conv_1.0.running_mean", "downsample.down.res_down_0.conv.conv_1.0.running_var", "downsample.down.res_down_0.conv.conv_1.2.weight", "downsample.down.res_down_0.conv.conv_1.2.bias", "downsample.down.res_down_0.conv.conv_2.0.weight", "downsample.down.res_down_0.conv.conv_2.0.bias", "downsample.down.res_down_0.conv.conv_2.0.running_mean", "downsample.down.res_down_0.conv.conv_2.0.running_var", "downsample.down.res_down_0.conv.conv_2.2.weight", "downsample.down.res_down_0.conv.conv_2.2.bias", "downsample.down.res_down_0.conv.conv_3.0.weight", "downsample.down.res_down_0.conv.conv_3.0.bias", "downsample.down.res_down_0.conv.conv_3.0.running_mean", "downsample.down.res_down_0.conv.conv_3.0.running_var", "downsample.down.res_down_0.conv.conv_3.2.weight", "downsample.down.res_down_0.conv.conv_3.2.bias", "downsample.down.res_down_0.proj.0.weight", "downsample.down.res_down_0.proj.0.bias", "downsample.down.res_down_0.proj.0.running_mean", "downsample.down.res_down_0.proj.0.running_var", "downsample.down.res_down_0.proj.1.weight", "downsample.down.res_down_0.proj.1.bias", "downsample.down.res_down_1.conv.conv_0.0.weight", "downsample.down.res_down_1.conv.conv_0.0.bias", "downsample.down.res_down_1.conv.conv_0.0.running_mean", "downsample.down.res_down_1.conv.conv_0.0.running_var", "downsample.down.res_down_1.conv.conv_0.2.weight", "downsample.down.res_down_1.conv.conv_0.2.bias", "downsample.down.res_down_1.conv.conv_1.0.weight", "downsample.down.res_down_1.conv.conv_1.0.bias", "downsample.down.res_down_1.conv.conv_1.0.running_mean", "downsample.down.res_down_1.conv.conv_1.0.running_var", "downsample.down.res_down_1.conv.conv_1.2.weight", "downsample.down.res_down_1.conv.conv_1.2.bias", "downsample.down.res_down_1.conv.conv_2.0.weight", "downsample.down.res_down_1.conv.conv_2.0.bias", "downsample.down.res_down_1.conv.conv_2.0.running_mean", "downsample.down.res_down_1.conv.conv_2.0.running_var", "downsample.down.res_down_1.conv.conv_2.2.weight", "downsample.down.res_down_1.conv.conv_2.2.bias", "downsample.down.res_down_1.conv.conv_3.0.weight", "downsample.down.res_down_1.conv.conv_3.0.bias", "downsample.down.res_down_1.conv.conv_3.0.running_mean", "downsample.down.res_down_1.conv.conv_3.0.running_var", "downsample.down.res_down_1.conv.conv_3.2.weight", "downsample.down.res_down_1.conv.conv_3.2.bias", "downsample.down.res_down_1.proj.0.weight", "downsample.down.res_down_1.proj.0.bias", "downsample.down.res_down_1.proj.0.running_mean", "downsample.down.res_down_1.proj.0.running_var", "downsample.down.res_down_1.proj.1.weight", "downsample.down.res_down_1.proj.1.bias", "downsample.down.res_down_2.conv.conv_0.0.weight", "downsample.down.res_down_2.conv.conv_0.0.bias", "downsample.down.res_down_2.conv.conv_0.0.running_mean", "downsample.down.res_down_2.conv.conv_0.0.running_var", "downsample.down.res_down_2.conv.conv_0.2.weight", "downsample.down.res_down_2.conv.conv_0.2.bias", "downsample.down.res_down_2.conv.conv_1.0.weight", "downsample.down.res_down_2.conv.conv_1.0.bias", "downsample.down.res_down_2.conv.conv_1.0.running_mean", "downsample.down.res_down_2.conv.conv_1.0.running_var", "downsample.down.res_down_2.conv.conv_1.2.weight", "downsample.down.res_down_2.conv.conv_1.2.bias", "downsample.down.res_down_2.conv.conv_2.0.weight", "downsample.down.res_down_2.conv.conv_2.0.bias", "downsample.down.res_down_2.conv.conv_2.0.running_mean", "downsample.down.res_down_2.conv.conv_2.0.running_var", "downsample.down.res_down_2.conv.conv_2.2.weight", "downsample.down.res_down_2.conv.conv_2.2.bias", "downsample.down.res_down_2.conv.conv_3.0.weight", "downsample.down.res_down_2.conv.conv_3.0.bias", "downsample.down.res_down_2.conv.conv_3.0.running_mean", "downsample.down.res_down_2.conv.conv_3.0.running_var", "downsample.down.res_down_2.conv.conv_3.2.weight", "downsample.down.res_down_2.conv.conv_3.2.bias", "downsample.down.res_down_2.proj.0.weight", "downsample.down.res_down_2.proj.0.bias", "downsample.down.res_down_2.proj.0.running_mean", "downsample.down.res_down_2.proj.0.running_var", "downsample.down.res_down_2.proj.1.weight", "downsample.down.res_down_2.proj.1.bias", "downsample.down.res_down_3.conv.conv_0.0.weight", "downsample.down.res_down_3.conv.conv_0.0.bias", "downsample.down.res_down_3.conv.conv_0.0.running_mean", "downsample.down.res_down_3.conv.conv_0.0.running_var", "downsample.down.res_down_3.conv.conv_0.2.weight", "downsample.down.res_down_3.conv.conv_0.2.bias", "downsample.down.res_down_3.conv.conv_1.0.weight", "downsample.down.res_down_3.conv.conv_1.0.bias", "downsample.down.res_down_3.conv.conv_1.0.running_mean", "downsample.down.res_down_3.conv.conv_1.0.running_var", "downsample.down.res_down_3.conv.conv_1.2.weight", "downsample.down.res_down_3.conv.conv_1.2.bias", "downsample.down.res_down_3.conv.conv_2.0.weight", "downsample.down.res_down_3.conv.conv_2.0.bias", "downsample.down.res_down_3.conv.conv_2.0.running_mean", "downsample.down.res_down_3.conv.conv_2.0.running_var", "downsample.down.res_down_3.conv.conv_2.2.weight", "downsample.down.res_down_3.conv.conv_2.2.bias", "downsample.down.res_down_3.conv.conv_3.0.weight", "downsample.down.res_down_3.conv.conv_3.0.bias", "downsample.down.res_down_3.conv.conv_3.0.running_mean", "downsample.down.res_down_3.conv.conv_3.0.running_var", "downsample.down.res_down_3.conv.conv_3.2.weight", "downsample.down.res_down_3.conv.conv_3.2.bias", "downsample.down.res_down_3.proj.0.weight", "downsample.down.res_down_3.proj.0.bias", "downsample.down.res_down_3.proj.0.running_mean", "downsample.down.res_down_3.proj.0.running_var", "downsample.down.res_down_3.proj.1.weight", "downsample.down.res_down_3.proj.1.bias", "upsample.up.res_up_0.conv.conv_0.0.weight", "upsample.up.res_up_0.conv.conv_0.0.bias", "upsample.up.res_up_0.conv.conv_0.0.running_mean", "upsample.up.res_up_0.conv.conv_0.0.running_var", "upsample.up.res_up_0.conv.conv_0.2.weight", "upsample.up.res_up_0.conv.conv_0.2.bias", "upsample.up.res_up_0.conv.conv_1.conv.0.weight", "upsample.up.res_up_0.conv.conv_1.conv.0.bias", "upsample.up.res_up_0.conv.conv_1.conv.0.running_mean", "upsample.up.res_up_0.conv.conv_1.conv.0.running_var", "upsample.up.res_up_0.conv.conv_1.conv.2.weight", "upsample.up.res_up_0.conv.conv_1.conv.2.bias", "upsample.up.res_up_0.conv.conv_1.full.weight", "upsample.up.res_up_0.conv.conv_1.full.bias", "upsample.up.res_up_0.conv.conv_2.conv.0.weight", "upsample.up.res_up_0.conv.conv_2.conv.0.bias", "upsample.up.res_up_0.conv.conv_2.conv.0.running_mean", "upsample.up.res_up_0.conv.conv_2.conv.0.running_var", "upsample.up.res_up_0.conv.conv_2.conv.2.weight", "upsample.up.res_up_0.conv.conv_2.conv.2.bias", "upsample.up.res_up_0.conv.conv_2.full.weight", "upsample.up.res_up_0.conv.conv_2.full.bias", "upsample.up.res_up_0.conv.conv_3.conv.0.weight", "upsample.up.res_up_0.conv.conv_3.conv.0.bias", "upsample.up.res_up_0.conv.conv_3.conv.0.running_mean", "upsample.up.res_up_0.conv.conv_3.conv.0.running_var", "upsample.up.res_up_0.conv.conv_3.conv.2.weight", "upsample.up.res_up_0.conv.conv_3.conv.2.bias", "upsample.up.res_up_0.conv.conv_3.full.weight", "upsample.up.res_up_0.conv.conv_3.full.bias", "upsample.up.res_up_0.proj.0.weight", "upsample.up.res_up_0.proj.0.bias", "upsample.up.res_up_0.proj.0.running_mean", "upsample.up.res_up_0.proj.0.running_var", "upsample.up.res_up_0.proj.1.weight", "upsample.up.res_up_0.proj.1.bias", "upsample.up.res_up_1.conv.conv_0.0.weight", "upsample.up.res_up_1.conv.conv_0.0.bias", "upsample.up.res_up_1.conv.conv_0.0.running_mean", "upsample.up.res_up_1.conv.conv_0.0.running_var", "upsample.up.res_up_1.conv.conv_0.2.weight", "upsample.up.res_up_1.conv.conv_0.2.bias", "upsample.up.res_up_1.conv.conv_1.conv.0.weight", "upsample.up.res_up_1.conv.conv_1.conv.0.bias", "upsample.up.res_up_1.conv.conv_1.conv.0.running_mean", "upsample.up.res_up_1.conv.conv_1.conv.0.running_var", "upsample.up.res_up_1.conv.conv_1.conv.2.weight", "upsample.up.res_up_1.conv.conv_1.conv.2.bias", "upsample.up.res_up_1.conv.conv_1.full.weight", "upsample.up.res_up_1.conv.conv_1.full.bias", "upsample.up.res_up_1.conv.conv_2.conv.0.weight", "upsample.up.res_up_1.conv.conv_2.conv.0.bias", "upsample.up.res_up_1.conv.conv_2.conv.0.running_mean", "upsample.up.res_up_1.conv.conv_2.conv.0.running_var", "upsample.up.res_up_1.conv.conv_2.conv.2.weight", "upsample.up.res_up_1.conv.conv_2.conv.2.bias", "upsample.up.res_up_1.conv.conv_2.full.weight", "upsample.up.res_up_1.conv.conv_2.full.bias", "upsample.up.res_up_1.conv.conv_3.conv.0.weight", "upsample.up.res_up_1.conv.conv_3.conv.0.bias", "upsample.up.res_up_1.conv.conv_3.conv.0.running_mean", "upsample.up.res_up_1.conv.conv_3.conv.0.running_var", "upsample.up.res_up_1.conv.conv_3.conv.2.weight", "upsample.up.res_up_1.conv.conv_3.conv.2.bias", "upsample.up.res_up_1.conv.conv_3.full.weight", "upsample.up.res_up_1.conv.conv_3.full.bias", "upsample.up.res_up_1.proj.0.weight", "upsample.up.res_up_1.proj.0.bias", "upsample.up.res_up_1.proj.0.running_mean", "upsample.up.res_up_1.proj.0.running_var", "upsample.up.res_up_1.proj.1.weight", "upsample.up.res_up_1.proj.1.bias", "upsample.up.res_up_2.conv.conv_0.0.weight", "upsample.up.res_up_2.conv.conv_0.0.bias", "upsample.up.res_up_2.conv.conv_0.0.running_mean", "upsample.up.res_up_2.conv.conv_0.0.running_var", "upsample.up.res_up_2.conv.conv_0.2.weight", "upsample.up.res_up_2.conv.conv_0.2.bias", "upsample.up.res_up_2.conv.conv_1.conv.0.weight", "upsample.up.res_up_2.conv.conv_1.conv.0.bias", "upsample.up.res_up_2.conv.con\')'
Traceback: '  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/dask/bag/core.py", line 1868, in reify\n    seq = list(seq)\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/dask/bag/core.py", line 2056, in __next__\n    return self.f(*vals)\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/vpt/app/context.py", line 166, in <lambda>\n    mp_bag = mp_bag.map(lambda b: _context_wrapper(**b))\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/vpt/app/context.py", line 163, in _context_wrapper\n    return task.proc(task.args)\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/vpt/run_segmentation_on_tile/__init__.py", line 11, in run\n    run_segmentation_on_tile(args)\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/vpt/run_segmentation_on_tile/main.py", line 113, in run_segmentation_on_tile\n    result = segmentation_on_tile(seg_spec, args.tile_index)\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/vpt/run_segmentation_on_tile/main.py", line 87, in segmentation_on_tile\n    tasks_result = get_tile_segmentation(seg_spec, window_info)\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/vpt/run_segmentation_on_tile/main.py", line 26, in get_tile_segmentation\n    seg_result = runner(\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/vpt_plugin_cellpose/segment.py", line 26, in run_segmentation\n    masks = predict.run(images, properties, parameters)\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/vpt_plugin_cellpose/predict.py", line 35, in run\n    model = models.CellposeModel(gpu=True, pretrained_model=properties.custom_weights)\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/cellpose/models.py", line 418, in __init__\n    self.net.load_model(self.pretrained_model[0], cpu=(not self.gpu))\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/cellpose/resnet_torch.py", line 221, in load_model\n    self.load_state_dict(torch.load(filename, map_location=torch.device(\'cpu\')))\n  File "/beegfs/scratch/ric.broccoli/kubacki.michal/conda/envs/cellpose/lib/python3.9/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict\n    raise RuntimeError(\n'

2025-06-10 17:46:23,706 - distributed.nanny - WARNING - Worker process still alive after 4.0 seconds, killing
2025-06-10 17:46:23,707 - distributed.nanny - WARNING - Worker process still alive after 4.0 seconds, killing
2025-06-10 17:46:23,708 - distributed.nanny - WARNING - Worker process still alive after 4.0 seconds, killing
